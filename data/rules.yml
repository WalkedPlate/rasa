version: "3.1"

rules:

# ========== REGLAS BÁSICAS ==========
- rule: Saludo inicial
  steps:
  - intent: greet
  - action: utter_greet

- rule: Despedida y finalización
  steps:
  - intent: goodbye
  - action: action_finalizar_chat

- rule: Mostrar menú principal
  steps:
  - intent: menu_principal
  - action: utter_menu_principal

# ========== CONSULTAS RÁPIDAS ESPECÍFICAS (GLOBAL) ==========
- rule: Consulta rápida papeletas con placa
  steps:
  - intent: consulta_rapida_papeletas_placa
  - action: action_consultar_papeletas

- rule: Consulta rápida papeletas con DNI
  steps:
  - intent: consulta_rapida_papeletas_dni
  - action: action_consultar_papeletas

- rule: Consulta rápida papeletas con RUC
  steps:
  - intent: consulta_rapida_papeletas_ruc
  - action: action_consultar_papeletas

- rule: Consulta rápida código de falta
  steps:
  - intent: consulta_rapida_codigo_falta
  - action: action_consultar_codigo_falta

- rule: Consulta rápida impuestos con placa
  steps:
  - intent: consulta_rapida_impuestos_placa
  - action: action_consultar_impuestos

- rule: Consulta rápida impuestos con DNI
  steps:
  - intent: consulta_rapida_impuestos_dni
  - action: action_consultar_impuestos

- rule: Consulta rápida impuestos con RUC
  steps:
  - intent: consulta_rapida_impuestos_ruc
  - action: action_consultar_impuestos

- rule: Consulta rápida impuestos con código contribuyente
  steps:
  - intent: consulta_rapida_impuestos_codigo
  - action: action_consultar_impuestos

# ========== NAVEGACIÓN A CONTEXTOS ==========
- rule: Ir a Casilla MTC
  steps:
  - intent: ir_a_casilla_mtc
  - action: utter_casilla_mtc

- rule: Ir a Pagos en línea
  steps:
  - intent: ir_a_pagos_linea
  - action: utter_pagos_linea

- rule: Ir a Papeletas
  steps:
  - intent: ir_a_papeletas
  - action: utter_papeletas_menu

- rule: Ir a Impuestos
  steps:
  - intent: ir_a_impuestos
  - action: utter_impuestos_menu

# ========== CONTEXTO PAPELETAS - CONSULTAS ESPECÍFICAS ==========
- rule: Papeletas - Consultar con placa
  steps:
  - intent: papeletas_consultar_placa
  - action: action_consultar_papeletas

- rule: Papeletas - Consultar con DNI
  steps:
  - intent: papeletas_consultar_dni
  - action: action_consultar_papeletas

- rule: Papeletas - Consultar con RUC
  steps:
  - intent: papeletas_consultar_ruc
  - action: action_consultar_papeletas

- rule: Papeletas - Consultar código de falta
  steps:
  - intent: papeletas_consultar_codigo_falta
  - action: action_consultar_codigo_falta

- rule: Papeletas - Consultar genérico
  steps:
  - intent: papeletas_consultar_generico
  - action: action_consultar_papeletas

- rule: Papeletas - Registrar
  steps:
  - intent: papeletas_registrar
  - action: utter_papeletas_registrar

- rule: Papeletas - Facilidades
  steps:
  - intent: papeletas_facilidades
  - action: utter_papeletas_facilidades

- rule: Papeletas - Frecuentes
  steps:
  - intent: papeletas_frecuentes
  - action: utter_papeletas_frecuentes

# ========== CONTEXTO IMPUESTOS - CONSULTAS ESPECÍFICAS ==========
- rule: Impuestos - Consultar con placa
  steps:
  - intent: impuestos_consultar_placa
  - action: action_consultar_impuestos

- rule: Impuestos - Consultar con DNI
  steps:
  - intent: impuestos_consultar_dni
  - action: action_consultar_impuestos

- rule: Impuestos - Consultar con RUC
  steps:
  - intent: impuestos_consultar_ruc
  - action: action_consultar_impuestos

- rule: Impuestos - Consultar con código contribuyente
  steps:
  - intent: impuestos_consultar_codigo
  - action: action_consultar_impuestos

- rule: Impuestos - Consultar genérico
  steps:
  - intent: impuestos_consultar_generico
  - action: action_consultar_impuestos

# ========== CONTEXTO IMPUESTOS - CUADERNILLO TRIBUTARIO ==========
- rule: Impuestos - Cuadernillo genérico
  steps:
  - intent: impuestos_cuadernillo
  - action: action_cuadernillo_agencia_virtual

- rule: Impuestos - Cuadernillo agencia virtual
  steps:
  - intent: impuestos_cuadernillo_agencia_virtual
  - action: action_cuadernillo_agencia_virtual

# ========== CONTEXTO IMPUESTOS - DECLARE Y LIQUIDE ==========
- rule: Impuestos - Declare y liquide genérico
  steps:
  - intent: impuestos_declarar_liquide
  - action: action_declaracion_impuesto_vehicular

- rule: Impuestos - Declaración vehicular
  steps:
  - intent: impuestos_declarar_vehicular
  - action: action_declaracion_impuesto_vehicular

- rule: Impuestos - Declaración predial
  steps:
  - intent: impuestos_declarar_predial
  - action: action_declaracion_impuesto_predial

- rule: Impuestos - Liquidación alcabala
  steps:
  - intent: impuestos_liquidar_alcabala
  - action: action_liquidacion_alcabala

- rule: Impuestos - Fraccionar deuda
  steps:
  - intent: impuestos_fraccionar_deuda
  - action: action_fraccionar_deuda

# ========== CONTEXTO IMPUESTOS - BENEFICIOS ==========
- rule: Impuestos - Beneficios genérico
  steps:
  - intent: impuestos_beneficios
  - action: action_beneficios_pensionista

- rule: Impuestos - Beneficios pensionista
  steps:
  - intent: impuestos_beneficios_pensionista
  - action: action_beneficios_pensionista

- rule: Impuestos - Beneficios adulto mayor
  steps:
  - intent: impuestos_beneficios_adulto_mayor
  - action: action_beneficios_adulto_mayor


# ========== NAVEGACIÓN A RETENCIÓN ==========
- rule: Ir a Retención y Captura
  steps:
  - intent: ir_a_retencion_captura
  - action: utter_retencion_menu

# ========== CONTEXTO RETENCIÓN - SUB-OPCIONES ==========
- rule: Retención - Embargo de cuentas
  steps:
  - intent: retencion_embargo_cuentas
  - action: action_retencion_embargo

- rule: Retención - Orden de captura
  steps:
  - intent: retencion_orden_captura
  - action: action_consultar_orden_captura

- rule: Retención - Vehículo internado
  steps:
  - intent: retencion_vehiculo_internado
  - action: action_retencion_vehiculo_internado

- rule: Retención - Suspender cobranza
  steps:
  - intent: retencion_suspender_cobranza
  - action: action_retencion_suspender_cobranza

- rule: Retención - Tercería de propiedad
  steps:
  - intent: retencion_terceria_propiedad
  - action: action_retencion_terceria_propiedad

- rule: Retención - Remate vehicular
  steps:
  - intent: retencion_remate_vehicular
  - action: action_retencion_remate_vehicular

- rule: Retención - Consultar con placa
  steps:
  - intent: retencion_consultar_placa
  - action: action_consultar_orden_captura

# ========== NAVEGACIÓN A ACTUALIZAR DATPS ==========
- rule: Ir a Actualizar Datos
  steps:
  - intent: ir_a_actualizar_datos
  - action: action_actualizar_datos

# ========== NAVEGACIÓN GLOBAL ==========
- rule: Otra consulta
  steps:
  - intent: otra_consulta
  - action: utter_otra_consulta

# ========== FALLBACK GLOBAL ==========
- rule: Fallback
  steps:
  - intent: nlu_fallback
  - action: utter_default

# ========== NAVEGACIÓN A LUGARES Y PAGOS ==========
- rule: Ir a Lugares y Pagos
  steps:
  - intent: ir_a_lugares_pagos
  - action: utter_lugares_pagos_menu

# ========== CONTEXTO LUGARES Y PAGOS - SUB-OPCIONES ==========
- rule: Lugares - Agencias y horarios
  steps:
  - intent: lugares_pagos_agencias_horarios
  - action: action_lugares_agencias_horarios

- rule: Lugares - Lugares de pago
  steps:
  - intent: lugares_pagos_lugares_pago
  - action: action_lugares_pago

- rule: Lugares - Formas de pago
  steps:
  - intent: lugares_pagos_formas_pago
  - action: action_lugares_formas_pago

# ========== NAVEGACIÓN A SERVICIOS VIRTUALES ==========
- rule: Ir a Servicios Virtuales
  steps:
  - intent: ir_a_servicios_virtuales
  - action: utter_servicios_virtuales_menu

# ========== CONTEXTO SERVICIOS VIRTUALES - SUB-OPCIONES ==========
- rule: Servicios - Mesa de partes
  steps:
  - intent: servicios_virtuales_mesa_partes
  - action: action_servicios_mesa_partes

- rule: Servicios - Agencia virtual
  steps:
  - intent: servicios_virtuales_agencia_virtual
  - action: action_servicios_agencia_virtual

- rule: Servicios - Pitazo
  steps:
  - intent: servicios_virtuales_pitazo
  - action: action_servicios_pitazo

- rule: Servicios - Correo
  steps:
  - intent: servicios_virtuales_correo
  - action: action_servicios_correo

- rule: Servicios - Libro de reclamaciones
  steps:
  - intent: servicios_virtuales_libro_reclamaciones
  - action: action_servicios_libro_reclamaciones

- rule: Servicios - Cursos
  steps:
  - intent: servicios_virtuales_cursos
  - action: action_servicios_cursos


# ========== NAVEGACIÓN A OTROS TRÁMITES ==========
- rule: Ir a Otros Trámites
  steps:
  - intent: ir_a_otros_tramites
  - action: utter_otros_tramites_menu

# ========== CONTEXTO OTROS TRÁMITES - CONSULTAS ==========
- rule: Trámites - Consultar número
  steps:
  - intent: tramites_consultar_numero
  - action: action_consultar_tramite

# ========== CONTEXTO OTROS TRÁMITES - SUB-OPCIONES ==========
- rule: Trámites - Requisitos papeletas
  steps:
  - intent: tramites_requisitos_papeletas
  - action: utter_tramites_requisitos_papeletas

- rule: Trámites - Requisitos tributarios
  steps:
  - intent: tramites_requisitos_tributarios
  - action: utter_tramites_requisitos_tributarios

- rule: Trámites - Constancias no adeudo
  steps:
  - intent: tramites_constancias_no_adeudo
  - action: action_tramites_constancias_no_adeudo


# ========== TRÁMITES PAPELETAS ESPECÍFICOS ==========
- rule: Trámites - Recurso reconsideración
  steps:
  - intent: tramites_recurso_reconsideracion
  - action: action_tramites_recurso_reconsideracion

- rule: Trámites - Descarga infracciones
  steps:
  - intent: tramites_descargo_infracciones
  - action: action_tramites_descargo_infracciones

- rule: Trámites - Apelación papeletas específica
  steps:
  - intent: tramites_apelacion_papeletas
  - action: action_tramites_apelacion_papeletas

- rule: Trámites - Prescripción papeletas
  steps:
  - intent: tramites_prescripcion_papeletas
  - action: action_tramites_prescripcion_papeletas

- rule: Trámites - Devolución papeletas
  steps:
  - intent: tramites_devolucion_papeletas
  - action: action_tramites_devolucion_papeletas

- rule: Trámites - Tercería requisitos
  steps:
  - intent: tramites_terceria_requisitos
  - action: action_tramites_terceria_requisitos

- rule: Trámites - Suspensión requisitos
  steps:
  - intent: tramites_suspension_requisitos
  - action: action_tramites_suspension_requisitos

# ========== TRÁMITES TRIBUTARIOS ESPECÍFICOS ==========
- rule: Trámites - Predial requisitos
  steps:
  - intent: tramites_predial_requisitos
  - action: action_tramites_predial_requisitos

- rule: Trámites - Vehicular requisitos
  steps:
  - intent: tramites_vehicular_requisitos
  - action: action_tramites_vehicular_requisitos

- rule: Trámites - Alcabala requisitos
  steps:
  - intent: tramites_alcabala_requisitos
  - action: action_tramites_alcabala_requisitos

- rule: Trámites - Reclamación tributaria
  steps:
  - intent: tramites_reclamacion_tributaria
  - action: action_tramites_reclamacion_tributaria

- rule: Trámites - Prescripción tributaria
  steps:
  - intent: tramites_prescripcion_tributaria
  - action: action_tramites_prescripcion_tributaria

- rule: Trámites - Devolución tributaria
  steps:
  - intent: tramites_devolucion_tributaria
  - action: action_tramites_devolucion_tributaria

- rule: Trámites - Apelación tributaria
  steps:
  - intent: tramites_apelacion_tributaria
  - action: action_tramites_apelacion_tributaria

- rule: Trámites - Tercería tributaria
  steps:
  - intent: tramites_terceria_tributaria
  - action: action_tramites_terceria_tributaria

- rule: Trámites - Suspensión tributaria
  steps:
  - intent: tramites_suspension_tributaria
  - action: action_tramites_suspension_tributaria


# ========== REGLAS PARA ACTUALIZAR DATOS ==========
- rule: Actualizar nombre
  steps:
  - intent: actualizar_nombre
  - action: action_actualizar_nombre

- rule: Actualizar documento
  steps:
  - intent: actualizar_documento
  - action: action_actualizar_documento

- rule: Datos correctos
  steps:
  - intent: datos_correctos
  - action: utter_menu_principal

- rule: Procesar nuevo nombre
  condition:
  - slot_was_set:
    - esperando_nuevo_nombre: true
  steps:
  - intent: proporcionar_nombre
  - action: action_procesar_nuevo_nombre

- rule: Procesar tipo documento
  condition:
  - slot_was_set:
    - esperando_tipo_documento: true
  steps:
  - intent: proporcionar_tipo_documento
  - action: action_procesar_tipo_documento

- rule: Procesar número documento
  condition:
  - slot_was_set:
    - esperando_numero_documento: true
  steps:
  - intent: proporcionar_numero_documento
  - action: action_procesar_numero_documento