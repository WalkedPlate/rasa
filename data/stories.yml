version: "3.1"

stories:

# ========== HISTORIAS BÁSICAS ORIGINALES ==========

- story: saludo inicial
  steps:
  - intent: greet
  - action: utter_greet

- story: despedida
  steps:
  - intent: goodbye
  - action: utter_goodbye

- story: finalizar chat directo
  steps:
  - intent: finalizar_chat
  - action: action_finalizar_chat

# ========== OPCIONES PRINCIPALES ==========

- story: consultar casilla mtc
  steps:
  - intent: casilla_mtc
  - action: utter_casilla_mtc

- story: consultar pagos en linea
  steps:
  - intent: pagos_linea
  - action: utter_pagos_linea

- story: entrada papeletas general
  steps:
  - intent: papeletas
  - action: utter_papeletas_menu

# ========== FLUJOS BÁSICOS DE PAPELETAS ==========

- story: consulta papeletas con placa confirmada
  steps:
  - intent: provide_placa
    entities:
    - placa: "ABC123"
  - action: action_consultar_papeletas
  - intent: confirm_yes
  - action: action_consultar_papeletas

- story: consulta papeletas con dni confirmado
  steps:
  - intent: provide_dni
    entities:
    - dni: "12345678"
  - action: action_consultar_papeletas
  - intent: confirm_yes
  - action: action_consultar_papeletas

- story: consulta papeletas con ruc confirmado
  steps:
  - intent: provide_ruc
    entities:
    - ruc: "20123456789"
  - action: action_consultar_papeletas
  - intent: confirm_yes
  - action: action_consultar_papeletas

# ========== FLUJOS CRÍTICOS - CAMBIOS DE CONTEXTO ==========

- story: cambio de placa a dni durante confirmacion
  steps:
  - intent: provide_placa
    entities:
    - placa: "ABC123"
  - action: action_consultar_papeletas
  - slot_was_set:
    - confirmacion_pendiente: true
  - intent: provide_dni
    entities:
    - dni: "12345678"
  - action: action_consultar_papeletas
  - intent: confirm_yes
  - action: action_consultar_papeletas

- story: cambio de dni a placa durante confirmacion
  steps:
  - intent: provide_dni
    entities:
    - dni: "12345678"
  - action: action_consultar_papeletas
  - slot_was_set:
    - confirmacion_pendiente: true
  - intent: provide_placa
    entities:
    - placa: "XYZ789"
  - action: action_consultar_papeletas
  - intent: confirm_yes
  - action: action_consultar_papeletas

- story: cambio de ruc a dni
  steps:
  - intent: provide_ruc
    entities:
    - ruc: "20123456789"
  - action: action_consultar_papeletas
  - intent: provide_dni
    entities:
    - dni: "87654321"
  - action: action_consultar_papeletas
  - intent: confirm_yes
  - action: action_consultar_papeletas

# ========== CORRECCIONES MÚLTIPLES ==========

- story: correccion simple placa
  steps:
  - intent: provide_placa
    entities:
    - placa: "ABC123"
  - action: action_consultar_papeletas
  - intent: confirm_no
  - action: action_consultar_papeletas
  - intent: provide_placa
    entities:
    - placa: "XYZ789"
  - action: action_consultar_papeletas
  - intent: confirm_yes
  - action: action_consultar_papeletas

- story: correccion multiple placa
  steps:
  - intent: provide_placa
    entities:
    - placa: "ABC123"
  - action: action_consultar_papeletas
  - intent: confirm_no
  - action: action_consultar_papeletas
  - intent: provide_placa
    entities:
    - placa: "DEF456"
  - action: action_consultar_papeletas
  - intent: confirm_no
  - action: action_consultar_papeletas
  - intent: provide_placa
    entities:
    - placa: "GHI789"
  - action: action_consultar_papeletas
  - intent: confirm_yes
  - action: action_consultar_papeletas

- story: correccion simple dni
  steps:
  - intent: provide_dni
    entities:
    - dni: "12345678"
  - action: action_consultar_papeletas
  - intent: confirm_no
  - action: action_consultar_papeletas
  - intent: provide_dni
    entities:
    - dni: "87654321"
  - action: action_consultar_papeletas
  - intent: confirm_yes
  - action: action_consultar_papeletas

- story: correccion simple ruc
  steps:
  - intent: provide_ruc
    entities:
    - ruc: "20123456789"
  - action: action_consultar_papeletas
  - intent: confirm_no
  - action: action_consultar_papeletas
  - intent: provide_ruc
    entities:
    - ruc: "10987654321"
  - action: action_consultar_papeletas
  - intent: confirm_yes
  - action: action_consultar_papeletas

# ========== FLUJOS DE CÓDIGOS DE FALTA ==========

- story: consulta codigo confirmado
  steps:
  - intent: provide_codigo_falta
    entities:
    - codigo_falta: "C15"
  - action: action_consultar_codigo_falta
  - intent: confirm_yes
  - action: action_consultar_codigo_falta

- story: correccion codigo falta
  steps:
  - intent: provide_codigo_falta
    entities:
    - codigo_falta: "C15"
  - action: action_consultar_codigo_falta
  - intent: confirm_no
  - action: action_consultar_codigo_falta
  - intent: provide_codigo_falta
    entities:
    - codigo_falta: "M08"
  - action: action_consultar_codigo_falta
  - intent: confirm_yes
  - action: action_consultar_codigo_falta

# ========== NAVEGACIÓN ENTRE OPCIONES ==========

- story: de papeletas a pagos en linea
  steps:
  - intent: papeletas
  - action: utter_papeletas_menu
  - intent: pagos_linea
  - action: utter_pagos_linea

- story: de pagos a papeletas
  steps:
  - intent: pagos_linea
  - action: utter_pagos_linea
  - intent: papeletas
  - action: utter_papeletas_menu

- story: de casilla mtc a papeletas
  steps:
  - intent: casilla_mtc
  - action: utter_casilla_mtc
  - intent: papeletas
  - action: utter_papeletas_menu

- story: de papeletas a casilla mtc
  steps:
  - intent: papeletas
  - action: utter_papeletas_menu
  - intent: casilla_mtc
  - action: utter_casilla_mtc

# ========== SUBMENÚS DE PAPELETAS ==========

- story: consulta y pago menu
  steps:
  - intent: consulta_pago
  - action: utter_consulta_pago_menu

- story: registrar papeleta directo
  steps:
  - intent: registrar_papeleta
  - action: utter_registrar_papeleta

- story: consultas frecuentes menu
  steps:
  - intent: consultas_frecuentes
  - action: utter_consultas_frecuentes_menu

- story: facilidad de pago directo
  steps:
  - intent: facilidad_pago
  - action: utter_facilidad_pago

# ========== DESDE MENÚS A ACCIONES ==========

- story: desde menu papeletas a consulta
  steps:
  - intent: papeletas
  - action: utter_papeletas_menu
  - intent: consulta_pago
  - action: utter_consulta_pago_menu

- story: desde menu papeletas a registrar
  steps:
  - intent: papeletas
  - action: utter_papeletas_menu
  - intent: registrar_papeleta
  - action: utter_registrar_papeleta

- story: desde menu papeletas a frecuentes
  steps:
  - intent: papeletas
  - action: utter_papeletas_menu
  - intent: consultas_frecuentes
  - action: utter_consultas_frecuentes_menu

- story: desde consulta menu a facilidades
  steps:
  - intent: consulta_pago
  - action: utter_consulta_pago_menu
  - intent: facilidad_pago
  - action: utter_facilidad_pago

# ========== CONSULTAS FRECUENTES ESPECÍFICAS ==========

- story: plazos y descuentos directo
  steps:
  - intent: plazos_descuentos
  - action: utter_plazos_descuentos

- story: responsable multa directo
  steps:
  - intent: responsable_multa
  - action: utter_responsable_multa

- story: imagen papeleta directo
  steps:
  - intent: imagen_papeleta
  - action: utter_imagen_papeleta

- story: consecuencias no pago directo
  steps:
  - intent: consecuencias_no_pago
  - action: utter_consecuencias_no_pago

- story: codigo infraccion directo
  steps:
  - intent: codigo_infraccion
  - action: action_consultar_codigo_falta

# ========== DESDE MENU FRECUENTES A OPCIONES ==========

- story: desde frecuentes a plazos
  steps:
  - intent: consultas_frecuentes
  - action: utter_consultas_frecuentes_menu
  - intent: plazos_descuentos
  - action: utter_plazos_descuentos

- story: desde frecuentes a responsable
  steps:
  - intent: consultas_frecuentes
  - action: utter_consultas_frecuentes_menu
  - intent: responsable_multa
  - action: utter_responsable_multa

- story: desde frecuentes a imagen
  steps:
  - intent: consultas_frecuentes
  - action: utter_consultas_frecuentes_menu
  - intent: imagen_papeleta
  - action: utter_imagen_papeleta

- story: desde frecuentes a codigo
  steps:
  - intent: consultas_frecuentes
  - action: utter_consultas_frecuentes_menu
  - intent: codigo_infraccion
  - action: action_consultar_codigo_falta

- story: desde frecuentes a consecuencias
  steps:
  - intent: consultas_frecuentes
  - action: utter_consultas_frecuentes_menu
  - intent: consecuencias_no_pago
  - action: utter_consecuencias_no_pago

# ========== FLUJOS INTERRUMPIDOS POR CAMBIO DE OPCIÓN ==========

- story: consulta interrumpida por pagos
  steps:
  - intent: provide_placa
    entities:
    - placa: "ABC123"
  - action: action_consultar_papeletas
  - slot_was_set:
    - confirmacion_pendiente: true
  - intent: pagos_linea
  - action: utter_pagos_linea

- story: consulta interrumpida por casilla
  steps:
  - intent: provide_dni
    entities:
    - dni: "12345678"
  - action: action_consultar_papeletas
  - slot_was_set:
    - confirmacion_pendiente: true
  - intent: casilla_mtc
  - action: utter_casilla_mtc

- story: codigo interrumpido por consulta
  steps:
  - intent: provide_codigo_falta
    entities:
    - codigo_falta: "C15"
  - action: action_consultar_codigo_falta
  - slot_was_set:
    - confirmacion_pendiente: true
  - intent: provide_placa
    entities:
    - placa: "XYZ789"
  - action: action_consultar_papeletas

# ========== DATOS SIN CONTEXTO PREVIO ==========

- story: placa sin contexto
  steps:
  - intent: provide_placa
    entities:
    - placa: "ABC123"
  - action: action_consultar_papeletas

- story: dni sin contexto
  steps:
  - intent: provide_dni
    entities:
    - dni: "12345678"
  - action: action_consultar_papeletas

- story: ruc sin contexto
  steps:
  - intent: provide_ruc
    entities:
    - ruc: "20123456789"
  - action: action_consultar_papeletas

- story: codigo sin contexto
  steps:
  - intent: provide_codigo_falta
    entities:
    - codigo_falta: "C15"
  - action: action_consultar_codigo_falta

# ========== FLUJOS COMPLEJOS COMBINADOS ==========

- story: flujo completo saludo papeletas consulta
  steps:
  - intent: greet
  - action: utter_greet
  - intent: papeletas
  - action: utter_papeletas_menu
  - intent: consulta_pago
  - action: utter_consulta_pago_menu
  - intent: provide_placa
    entities:
    - placa: "ABC123"
  - action: action_consultar_papeletas
  - intent: confirm_yes
  - action: action_consultar_papeletas
  - intent: goodbye
  - action: utter_goodbye

- story: flujo con correccion y cambio de tipo
  steps:
  - intent: greet
  - action: utter_greet
  - intent: provide_placa
    entities:
    - placa: "ABC123"
  - action: action_consultar_papeletas
  - intent: confirm_no
  - action: action_consultar_papeletas
  - intent: provide_dni
    entities:
    - dni: "12345678"
  - action: action_consultar_papeletas
  - intent: confirm_yes
  - action: action_consultar_papeletas
  - intent: finalizar_chat
  - action: action_finalizar_chat

- story: usuario indeciso multiples opciones
  steps:
  - intent: greet
  - action: utter_greet
  - intent: papeletas
  - action: utter_papeletas_menu
  - intent: pagos_linea
  - action: utter_pagos_linea
  - intent: casilla_mtc
  - action: utter_casilla_mtc
  - intent: provide_placa
    entities:
    - placa: "XYZ789"
  - action: action_consultar_papeletas
  - intent: confirm_yes
  - action: action_consultar_papeletas

# ========== MANEJO DE ERRORES Y FALLBACKS ==========

- story: datos invalidos seguidos de validos
  steps:
  - intent: provide_placa
    entities:
    - placa: "INVALID"
  - action: action_consultar_papeletas
  - intent: provide_placa
    entities:
    - placa: "ABC123"
  - action: action_consultar_papeletas
  - intent: confirm_yes
  - action: action_consultar_papeletas

- story: multiple datos invalidos
  steps:
  - intent: provide_dni
    entities:
    - dni: "123"
  - action: action_consultar_papeletas
  - intent: provide_dni
    entities:
    - dni: "1234567"
  - action: action_consultar_papeletas
  - intent: provide_dni
    entities:
    - dni: "12345678"
  - action: action_consultar_papeletas
  - intent: confirm_yes
  - action: action_consultar_papeletas