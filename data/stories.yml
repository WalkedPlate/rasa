version: "3.1"

stories:

# ========== HISTORIAS BÁSICAS ==========

- story: saludo inicial
  steps:
  - intent: greet
  - action: utter_greet

- story: despedida
  steps:
  - intent: goodbye
  - action: utter_goodbye

- story: finalizar chat directo
  steps:
  - intent: finalizar_chat
  - action: action_finalizar_chat

# ========== HISTORIAS OPCIONES PRINCIPALES ==========

# OPCIÓN 1: CASILLA MTC (Respuesta Simple)
- story: consultar casilla mtc
  steps:
  - intent: casilla_mtc
  - action: utter_casilla_mtc

# OPCIÓN 2: PAGOS EN LÍNEA (Respuesta Simple)
- story: consultar pagos en linea
  steps:
  - intent: pagos_linea
  - action: utter_pagos_linea

# OPCIÓN 3: PAPELETAS - Menú Principal
- story: entrada papeletas general
  steps:
  - intent: papeletas
  - action: utter_papeletas_menu

# ========== HISTORIAS PAPELETAS - CONSULTA Y PAGO ==========

# Flujo directo con placa
- story: consulta papeletas con placa directa
  steps:
  - intent: consultar_deuda
    entities:
    - placa: "ABC123"
  - slot_was_set:
    - placa: "ABC123"
  - action: action_consultar_papeletas

# Flujo directo con DNI
- story: consulta papeletas con dni directo
  steps:
  - intent: consultar_deuda
    entities:
    - dni: "12345678"
  - slot_was_set:
    - dni: "12345678"
  - action: action_consultar_papeletas

# Flujo directo con RUC
- story: consulta papeletas con ruc directo
  steps:
  - intent: consultar_deuda
    entities:
    - ruc: "20123456789"
  - slot_was_set:
    - ruc: "20123456789"
  - action: action_consultar_papeletas

# Flujo paso a paso - consulta y pago
- story: consulta pago paso a paso
  steps:
  - intent: consulta_pago
  - action: utter_consulta_pago_menu
  - intent: consultar_deuda
  - action: action_consultar_papeletas

# Consulta sin datos - el action maneja todo
- story: consulta sin datos iniciales
  steps:
  - intent: consultar_deuda
  - action: action_consultar_papeletas

# Facilidades de pago
- story: consultar facilidades pago
  steps:
  - intent: facilidad_pago
  - action: utter_facilidad_pago

# Desde menú a facilidades
- story: menu a facilidades pago
  steps:
  - intent: consulta_pago
  - action: utter_consulta_pago_menu
  - intent: facilidad_pago
  - action: utter_facilidad_pago

# ========== HISTORIAS PAPELETAS - REGISTRAR ==========

- story: registrar papeleta directa
  steps:
  - intent: registrar_papeleta
  - action: utter_registrar_papeleta

# Desde menú papeletas a registrar
- story: menu papeletas a registrar
  steps:
  - intent: papeletas
  - action: utter_papeletas_menu
  - intent: registrar_papeleta
  - action: utter_registrar_papeleta

# ========== HISTORIAS CONSULTAS FRECUENTES ==========

# Entrada a consultas frecuentes
- story: consultas frecuentes general
  steps:
  - intent: consultas_frecuentes
  - action: utter_consultas_frecuentes_menu

# Desde menú papeletas a frecuentes
- story: menu papeletas a frecuentes
  steps:
  - intent: papeletas
  - action: utter_papeletas_menu
  - intent: consultas_frecuentes
  - action: utter_consultas_frecuentes_menu

# Plazos y descuentos
- story: consultar plazos descuentos
  steps:
  - intent: plazos_descuentos
  - action: utter_plazos_descuentos

# Desde menú frecuentes a plazos
- story: menu frecuentes a plazos
  steps:
  - intent: consultas_frecuentes
  - action: utter_consultas_frecuentes_menu
  - intent: plazos_descuentos
  - action: utter_plazos_descuentos

# Responsable multa
- story: consultar responsable multa
  steps:
  - intent: responsable_multa
  - action: utter_responsable_multa

# Imagen papeleta
- story: consultar imagen papeleta
  steps:
  - intent: imagen_papeleta
  - action: utter_imagen_papeleta

# Consecuencias no pago
- story: consultar consecuencias no pago
  steps:
  - intent: consecuencias_no_pago
  - action: utter_consecuencias_no_pago

# Código de infracción directo con código
- story: codigo infraccion con codigo directo
  steps:
  - intent: codigo_infraccion
    entities:
    - codigo_falta: "C15"
  - slot_was_set:
    - codigo_falta: "C15"
  - action: action_consultar_codigo_falta

# Código de infracción sin código
- story: codigo infraccion sin codigo
  steps:
  - intent: codigo_infraccion
  - action: action_consultar_codigo_falta

# Desde menú frecuentes a código
- story: menu frecuentes a codigo
  steps:
  - intent: consultas_frecuentes
  - action: utter_consultas_frecuentes_menu
  - intent: codigo_infraccion
  - action: action_consultar_codigo_falta

# ========== HISTORIAS DE CORRECCIÓN ==========

# Corrección manejada por el action inteligente
- story: correccion datos incorrectos
  steps:
  - intent: consultar_deuda
    entities:
    - placa: "ABC123"
  - action: action_consultar_papeletas
  - intent: confirm_no
  - action: action_consultar_papeletas
  - intent: provide_placa
    entities:
    - placa: "XYZ789"
  - action: action_consultar_papeletas

# Corrección de código de falta
- story: correccion codigo falta
  steps:
  - intent: codigo_infraccion
    entities:
    - codigo_falta: "C15"
  - action: action_consultar_codigo_falta
  - intent: confirm_no
  - action: action_consultar_codigo_falta
  - intent: provide_codigo_falta
    entities:
    - codigo_falta: "M08"
  - action: action_consultar_codigo_falta

# ========== HISTORIAS DE NAVEGACIÓN ENTRE OPCIONES ==========

# De papeletas a pagos
- story: papeletas a pagos linea
  steps:
  - intent: papeletas
  - action: utter_papeletas_menu
  - intent: pagos_linea
  - action: utter_pagos_linea

# De pagos a papeletas
- story: pagos a papeletas
  steps:
  - intent: pagos_linea
  - action: utter_pagos_linea
  - intent: papeletas
  - action: utter_papeletas_menu

# De casilla a papeletas
- story: casilla a papeletas
  steps:
  - intent: casilla_mtc
  - action: utter_casilla_mtc
  - intent: papeletas
  - action: utter_papeletas_menu

# De consultas frecuentes a consulta pago
- story: frecuentes a consulta pago
  steps:
  - intent: consultas_frecuentes
  - action: utter_consultas_frecuentes_menu
  - intent: consulta_pago
  - action: utter_consulta_pago_menu

# ========== HISTORIAS COMBINADAS ==========

# Flujo completo: saludo + papeletas + consulta
- story: flujo completo saludo papeletas consulta
  steps:
  - intent: greet
  - action: utter_greet
  - intent: consultar_deuda
    entities:
    - placa: "ABC123"
  - action: action_consultar_papeletas
  - intent: goodbye
  - action: utter_goodbye

# Flujo papeletas + código + finalizar
- story: flujo papeletas codigo finalizar
  steps:
  - intent: papeletas
  - action: utter_papeletas_menu
  - intent: consultas_frecuentes
  - action: utter_consultas_frecuentes_menu
  - intent: codigo_infraccion
    entities:
    - codigo_falta: "C15"
  - action: action_consultar_codigo_falta
  - intent: finalizar_chat
  - action: action_finalizar_chat

# Usuario indeciso - múltiples consultas
- story: usuario indeciso multiples consultas
  steps:
  - intent: greet
  - action: utter_greet
  - intent: papeletas
  - action: utter_papeletas_menu
  - intent: pagos_linea
  - action: utter_pagos_linea
  - intent: casilla_mtc
  - action: utter_casilla_mtc
  - intent: consultar_deuda
    entities:
    - placa: "XYZ789"
  - action: action_confirmar_dato
  - intent: confirm_yes
  - action: action_consultar_papeletas_api

# ========== HISTORIAS DE DATOS SIN CONTEXTO ==========

# Usuario proporciona datos sin contexto claro
- story: placa sin contexto
  steps:
  - intent: provide_placa
    entities:
    - placa: "ABC123"
  - action: utter_ask_tipo_consulta
  - intent: consultar_deuda
  - action: action_confirmar_dato
  - intent: confirm_yes
  - action: action_consultar_papeletas_api

# DNI sin contexto
- story: dni sin contexto
  steps:
  - intent: provide_dni
    entities:
    - dni: "12345678"
  - action: utter_ask_tipo_consulta
  - intent: consultar_deuda
  - action: action_confirmar_dato
  - intent: confirm_yes
  - action: action_consultar_papeletas_api

# Código de falta sin contexto
- story: codigo falta sin contexto
  steps:
  - intent: provide_codigo_falta
    entities:
    - codigo_falta: "C15"
  - action: utter_ask_codigo_falta
  - intent: codigo_infraccion
  - action: action_confirmar_dato
  - intent: confirm_yes
  - action: action_consultar_codigo_falta_api