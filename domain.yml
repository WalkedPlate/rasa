version: "3.1"

intents:
  # ========== INTENTS BÃSICOS ==========
  - greet
  - goodbye
  - finalizar_chat
  - confirm_yes
  - confirm_no

  # ========== OPCIONES PRINCIPALES SAT ==========
  # OpciÃ³n 1: CASILLA MTC
  - casilla_mtc

  # OpciÃ³n 2: PAGOS EN LÃNEA
  - pagos_linea

  # OpciÃ³n 3: PAPELETAS
  - papeletas                    # Entrada general a papeletas
  - consulta_pago               # A. Consulta y Paga
  - registrar_papeleta          # B. Registrar Papeleta
  - consultas_frecuentes        # C. Consultas Frecuentes

  # ========== SUB-OPCIONES PAPELETAS ==========
  # Para Consulta y Pago
  - consultar_deuda             # Consultar por DNI/Placa/RUC + API
  - facilidad_pago              # InformaciÃ³n sobre facilidades

  # Para Consultas Frecuentes
  - plazos_descuentos           # Enlaces informativos
  - responsable_multa           # Enlaces informativos
  - imagen_papeleta             # Enlaces informativos
  - codigo_infraccion           # Requiere cÃ³digo + API
  - consecuencias_no_pago       # InformaciÃ³n sobre no pagar

  # ========== INTENTS DE DATOS ==========
  - provide_placa
  - provide_dni
  - provide_ruc
  - provide_codigo_falta

  # ========== INTENTS FUTUROS (preparados) ==========
  # Nota: Estos se habilitarÃ¡n cuando implementemos las opciones 4-9
  # - impuestos                 # OpciÃ³n 4
  # - retencion_captura         # OpciÃ³n 5
  # - actualizar_datos          # OpciÃ³n 6
  # - lugares_pagos             # OpciÃ³n 7
  # - servicios_virtuales       # OpciÃ³n 8
  # - otros_tramites            # OpciÃ³n 9

entities:
  # Datos de identificaciÃ³n
  - placa
  - dni
  - ruc
  - codigo_falta

  # Tipos de consulta para papeletas
  - consulta_type
  - frecuentes_type

  # Entidades futuras (preparadas)
  # - impuesto_type
  # - tramite_type
  # - servicio_type

slots:
  # ========== SLOTS PARA DATOS DE USUARIO ==========
  placa:
    type: text
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: placa

  dni:
    type: text
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: dni

  ruc:
    type: text
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: ruc

  codigo_falta:
    type: text
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: codigo_falta

  # ========== SLOTS PARA CONTEXTO ==========
  esperando_confirmacion:
    type: bool
    initial_value: false
    influence_conversation: true
    mappings:
    - type: custom

  tipo_consulta_actual:
    type: text
    influence_conversation: true
    mappings:
    - type: custom

  dato_detectado:
    type: text
    influence_conversation: true
    mappings:
    - type: custom

  # ========== SLOTS FUTUROS (preparados) ==========
  # codigo_contribuyente:
  #   type: text
  #   influence_conversation: true
  #   mappings:
  #   - type: from_entity
  #     entity: codigo_contribuyente

responses:
  # ========== RESPUESTAS BÃSICAS ==========
  utter_greet:
  - text: |
      Â¡Hola! Bienvenido al SAT de Lima ğŸ‘‹

      Puedo ayudarte con:

      ğŸš— **Consultar papeletas** - Dime tu placa, DNI o RUC
      ğŸ’³ **Pagos en lÃ­nea** - InformaciÃ³n para pagar por internet  
      ğŸ“‹ **Casilla MTC** - Registro obligatorio para trÃ¡mites
      â“ **Consultas frecuentes** - Plazos, cÃ³digos, descuentos

      Solo dime quÃ© necesitas en tus propias palabras. Por ejemplo:
      â€¢ 'Quiero ver las multas de mi carro ABC123'
      â€¢ 'CÃ³mo puedo pagar en lÃ­nea'
      â€¢ 'QuÃ© significa el cÃ³digo C15'

      Â¿En quÃ© te puedo ayudar?

  utter_goodbye:
  - text: |
      Â¡Gracias por usar el SAT de Lima! ğŸ‘‹
      
      Espero haber sido de ayuda. Puedes regresar cuando necesites consultando nuevamente.
      
      Â¡Que tengas un buen dÃ­a! ğŸ˜Š

  # ========== RESPUESTAS OPCIONES PRINCIPALES ==========
  utter_casilla_mtc:
  - text: |
      Para iniciar un procedimiento administrativo vinculado a trÃ¡nsito o transporte, es obligatorio inscribirse en la Casilla ElectrÃ³nica del MTC, asÃ­ recibirÃ¡s oportunamente nuestras comunicaciones.
      ğŸ“Œhttps://casilla.mtc.gob.pe/#/registro
      Base Legal: R. Directoral NÂ°023-2024-MTC/18

  utter_pagos_linea:
  - text: |
      Para pagos ingrese aquÃ­: 
      ğŸ“Œhttps://www.sat.gob.pe/pagosenlinea/

      Espero que la informaciÃ³n brindada le haya sido Ãºtil ğŸ¤—

  # ========== RESPUESTAS PAPELETAS ==========
  utter_papeletas_menu:
  - text: |
      Te ayudo con papeletas. Â¿QuÃ© necesitas hacer?

      ğŸ” **Consultar deuda** - Con placa, DNI o RUC
      ğŸ“ **Registrar papeleta** - Si no aparece en el sistema
      â“ **Consultas frecuentes** - Plazos, cÃ³digos, descuentos

      Puedes decirme algo como:
      â€¢ 'Ver multas de mi placa ABC123'
      â€¢ 'Registrar una papeleta'
      â€¢ 'InformaciÃ³n sobre plazos'

  utter_consulta_pago_menu:
  - text: |
      Para consultar tu deuda de papeletas puedo buscar por:

      ğŸš— **Placa del vehÃ­culo**
      ğŸ†” **Tu DNI** 
      ğŸ¢ **RUC de empresa**

      TambiÃ©n puedo informarte sobre **facilidades de pago**.

      Â¿QuÃ© opciÃ³n prefieres?

  utter_registrar_papeleta:
  - text: |
      Si no figura su papeleta ingrese a Registra y paga tu papeleta aquÃ­: 
      ğŸ“Œhttps://www.sat.gob.pe/websitev8/Popupv2.aspx?t=9&v=%20

  utter_facilidad_pago:
  - text: |
      Puede realizarlo por nuestra Agencia Virtual SAT, para registrarse ir al siguiente link:
      ğŸ“Œhttps://www.SAT.gob.pe/websitev9/Servicios/AgenciaVirtual

      Luego de registrarse ingrese en la opciÃ³n Facilidades de pago.

      Le sugerimos ingresar al siguiente enlace para que pueda guiarse del procedimiento de agencia virtual: 
      ğŸ“Œhttps://www.SAT.gob.pe/AgenciaVirtual/guiainteractiva/

      Para iniciar un procedimiento administrativo vinculado a trÃ¡nsito o transporte, es obligatorio inscribirse en la Casilla ElectrÃ³nica del MTC, asÃ­ recibirÃ¡s oportunamente nuestras comunicaciones.
      ğŸ“Œhttps://casilla.mtc.gob.pe/#/registro
      Base Legal: R. Directoral NÂ°023-2024-MTC/18

  # ========== RESPUESTAS CONSULTAS FRECUENTES ==========
  utter_consultas_frecuentes_menu:
  - text: |
      Â¿QuÃ© informaciÃ³n necesitas sobre papeletas?

      ğŸ“… **Plazos y descuentos** - InformaciÃ³n sobre fechas de pago
      ğŸ‘¤ **Responsable de multa** - QuiÃ©n debe pagar
      ğŸ“· **Imagen de papeleta** - Ver foto de la infracciÃ³n
      ğŸ”¢ **CÃ³digo de infracciÃ³n** - Consultar quÃ© significa un cÃ³digo
      âš ï¸ **Consecuencias de no pagar** - QuÃ© pasa si no pagas

      Â¿Sobre quÃ© quieres informaciÃ³n?

  utter_plazos_descuentos:
  - text: |
      Estimado ciudadano, puede verificar la informaciÃ³n en el siguiente enlace:
      ğŸ“Œhttps://www.sat.gob.pe/WebSiteV8/Modulos/contenidos/mult_Papeletas_ti_rntv2.aspx

  utter_responsable_multa:
  - text: |
      Estimado ciudadano, puede verificar la informaciÃ³n en el siguiente enlace:
      ğŸ“Œhttps://www.sat.gob.pe/WebSiteV8/Modulos/contenidos/mult_Papeletas_ti_rntv2.aspx

  utter_imagen_papeleta:
  - text: |
      Estimado ciudadano, para consultar su papeleta ingrese aquÃ­:
      ğŸ“Œhttps://www.sat.gob.pe/WebSitev8/IncioOV2.aspx

  utter_consecuencias_no_pago:
  - text: |
      Estimado ciudadano, si no paga su papeleta dentro de los plazos establecidos, perderÃ¡ el beneficio. 

      Puede verificar los descuentos en el siguiente link: 
      ğŸ“Œhttps://www.sat.gob.pe/websitev9/TributosMultas/Papeletas/InformacionCodigodeTransito, numeral 6.

  # ========== RESPUESTAS DE CONFIRMACIÃ“N ==========
  utter_confirmar_placa:
  - text: "DetectÃ© la placa {placa}. Â¿Es correcta?"

  utter_confirmar_dni:
  - text: "DetectÃ© el DNI {dni}. Â¿Es correcto?"

  utter_confirmar_ruc:
  - text: "DetectÃ© el RUC {ruc}. Â¿Es correcto?"

  utter_confirmar_codigo_falta:
  - text: "DetectÃ© el cÃ³digo de falta {codigo_falta}. Â¿Es correcto?"

  # ========== RESPUESTAS DE SOLICITUD DE DATOS ==========
  utter_ask_placa:
  - text: "Para consultar papeletas necesito la placa del vehÃ­culo. Â¿CuÃ¡l es tu placa?"

  utter_ask_dni:
  - text: "Para consultar por DNI, Â¿cuÃ¡l es tu nÃºmero de documento?"

  utter_ask_ruc:
  - text: "Para consultar por RUC, Â¿cuÃ¡l es el nÃºmero de RUC?"

  utter_ask_codigo_falta:
  - text: "Estimado ciudadano, indique el *CÃ“DIGO DE FALTA*:"

  utter_ask_tipo_consulta:
  - text: |
      Â¿CÃ³mo quieres consultar tus papeletas?

      ğŸš— **Por placa** - Dime el nÃºmero de placa
      ğŸ†” **Por DNI** - Dime tu DNI
      ğŸ¢ **Por RUC** - Dime el RUC de tu empresa

  # ========== RESPUESTAS DE ERROR ==========
  utter_default:
  - text: |
      No entendÃ­ completamente tu solicitud. Puedo ayudarte con:

      ğŸš— **Papeletas** - Consultas, registro, informaciÃ³n
      ğŸ’³ **Pagos en lÃ­nea** - Enlaces para pagar
      ğŸ“‹ **Casilla MTC** - InformaciÃ³n de registro

      Â¿PodrÃ­as ser mÃ¡s especÃ­fico? Por ejemplo:
      â€¢ 'Consultar papeletas de mi placa ABC123'
      â€¢ 'InformaciÃ³n de pagos'

  utter_dato_invalido:
  - text: "El dato proporcionado no tiene el formato correcto. Â¿PodrÃ­as verificarlo y proporcionarlo nuevamente?"

actions:
  # ========== ACTIONS BÃSICAS ==========
  - utter_greet
  - utter_goodbye
  - utter_default
  - utter_dato_invalido

  # ========== ACTIONS OPCIONES PRINCIPALES ==========
  - utter_casilla_mtc
  - utter_pagos_linea

  # ========== ACTIONS PAPELETAS ==========
  - utter_papeletas_menu
  - utter_consulta_pago_menu
  - utter_registrar_papeleta
  - utter_facilidad_pago
  - utter_consultas_frecuentes_menu

  # ========== ACTIONS CONSULTAS FRECUENTES ==========
  - utter_plazos_descuentos
  - utter_responsable_multa
  - utter_imagen_papeleta
  - utter_consecuencias_no_pago

  # ========== ACTIONS DE CONFIRMACIÃ“N ==========
  - utter_confirmar_placa
  - utter_confirmar_dni
  - utter_confirmar_ruc
  - utter_confirmar_codigo_falta

  # ========== ACTIONS DE SOLICITUD ==========
  - utter_ask_placa
  - utter_ask_dni
  - utter_ask_ruc
  - utter_ask_codigo_falta
  - utter_ask_tipo_consulta

  # ========== CUSTOM ACTIONS (APIs) ==========
  - action_consultar_papeletas
  - action_consultar_codigo_falta
  - action_finalizar_chat

  # ========== ACTIONS FUTURAS (preparadas) ==========
  # - action_consultar_impuestos
  # - action_consultar_retencion

session_config:
  session_expiration_time: 60
  carry_over_slots_to_new_session: false