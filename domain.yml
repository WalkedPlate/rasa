version: "3.1"

intents:
  # ========== INTENTS BÁSICOS ==========
  - greet
  - goodbye
  - finalizar_chat
  - confirm_yes
  - confirm_no

  # ========== OPCIONES PRINCIPALES SAT ==========
  # Opción 1: CASILLA MTC
  - casilla_mtc

  # Opción 2: PAGOS EN LÍNEA
  - pagos_linea

  # Opción 3: PAPELETAS
  - papeletas                    # Entrada general a papeletas
  - consulta_pago               # A. Consulta y Paga
  - registrar_papeleta          # B. Registrar Papeleta
  - consultas_frecuentes        # C. Consultas Frecuentes

  # ========== SUB-OPCIONES PAPELETAS ==========
  # Para Consulta y Pago
  - consultar_deuda             # Consultar por DNI/Placa/RUC + API
  - facilidad_pago              # Información sobre facilidades

  # Para Consultas Frecuentes
  - plazos_descuentos           # Enlaces informativos
  - responsable_multa           # Enlaces informativos
  - imagen_papeleta             # Enlaces informativos
  - codigo_infraccion           # Requiere código + API
  - consecuencias_no_pago       # Información sobre no pagar

  # ========== INTENTS DE DATOS ==========
  - provide_placa
  - provide_dni
  - provide_codigo_falta

  # ========== INTENTS FUTUROS (preparados) ==========
  # Nota: Estos se habilitarán cuando implementemos las opciones 4-9
  # - impuestos                 # Opción 4
  # - retencion_captura         # Opción 5
  # - actualizar_datos          # Opción 6
  # - lugares_pagos             # Opción 7
  # - servicios_virtuales       # Opción 8
  # - otros_tramites            # Opción 9

entities:
  # Datos de identificación
  - placa
  - dni
  - codigo_falta

  # Tipos de consulta para papeletas
  - consulta_type
  - frecuentes_type

  # Entidades futuras (preparadas)
  # - ruc
  # - impuesto_type
  # - tramite_type
  # - servicio_type

slots:
  # ========== SLOTS PARA DATOS DE USUARIO ==========
  placa:
    type: text
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: placa

  dni:
    type: text
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: dni

  codigo_falta:
    type: text
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: codigo_falta

  # ========== SLOTS PARA CONTEXTO ==========
  esperando_confirmacion:
    type: bool
    initial_value: false
    influence_conversation: true
    mappings:
    - type: custom

  tipo_consulta_actual:
    type: text
    influence_conversation: true
    mappings:
    - type: custom

  dato_detectado:
    type: text
    influence_conversation: true
    mappings:
    - type: custom

  # ========== SLOTS FUTUROS (preparados) ==========
  # ruc:
  #   type: text
  #   influence_conversation: true
  #   mappings:
  #   - type: from_entity
  #     entity: ruc
  # codigo_contribuyente:
  #   type: text
  #   influence_conversation: true
  #   mappings:
  #   - type: from_entity
  #     entity: codigo_contribuyente

responses:
  # ========== RESPUESTAS BÁSICAS ==========
  utter_greet:
  - text: |
      ¡Hola! Bienvenido al SAT de Lima 👋

      Puedo ayudarte con:

      🚗 **Consultar papeletas** - Dime tu placa, DNI o RUC
      💳 **Pagos en línea** - Información para pagar por internet  
      📋 **Casilla MTC** - Registro obligatorio para trámites
      ❓ **Consultas frecuentes** - Plazos, códigos, descuentos

      Solo dime qué necesitas en tus propias palabras. Por ejemplo:
      • 'Quiero ver las multas de mi carro ABC123'
      • 'Cómo puedo pagar en línea'
      • 'Qué significa el código C15'

      ¿En qué te puedo ayudar?

  utter_goodbye:
  - text: |
      ¡Gracias por usar el SAT de Lima! 👋
      
      Espero haber sido de ayuda. Puedes regresar cuando necesites consultando nuevamente.
      
      ¡Que tengas un buen día! 😊

  # ========== RESPUESTAS OPCIONES PRINCIPALES ==========
  utter_casilla_mtc:
  - text: |
      Para iniciar un procedimiento administrativo vinculado a tránsito o transporte, es obligatorio inscribirse en la Casilla Electrónica del MTC, así recibirás oportunamente nuestras comunicaciones.
      📌https://casilla.mtc.gob.pe/#/registro
      Base Legal: R. Directoral N°023-2024-MTC/18

  utter_pagos_linea:
  - text: |
      Para pagos ingrese aquí: 
      📌https://www.sat.gob.pe/pagosenlinea/

      Espero que la información brindada le haya sido útil 🤗

  # ========== RESPUESTAS PAPELETAS ==========
  utter_papeletas_menu:
  - text: |
      Te ayudo con papeletas. ¿Qué necesitas hacer?

      🔍 **Consultar deuda** - Con placa, DNI o RUC
      📝 **Registrar papeleta** - Si no aparece en el sistema
      ❓ **Consultas frecuentes** - Plazos, códigos, descuentos

      Puedes decirme algo como:
      • 'Ver multas de mi placa ABC123'
      • 'Registrar una papeleta'
      • 'Información sobre plazos'

  utter_consulta_pago_menu:
  - text: |
      Para consultar tu deuda de papeletas puedo buscar por:

      🚗 **Placa del vehículo**
      🆔 **Tu DNI** 
      🏢 **RUC de empresa**

      También puedo informarte sobre **facilidades de pago**.

      ¿Qué opción prefieres?

  utter_registrar_papeleta:
  - text: |
      Si no figura su papeleta ingrese a Registra y paga tu papeleta aquí: 
      📌https://www.sat.gob.pe/websitev8/Popupv2.aspx?t=9&v=%20

  utter_facilidad_pago:
  - text: |
      Puede realizarlo por nuestra Agencia Virtual SAT, para registrarse ir al siguiente link:
      📌https://www.SAT.gob.pe/websitev9/Servicios/AgenciaVirtual

      Luego de registrarse ingrese en la opción Facilidades de pago.

      Le sugerimos ingresar al siguiente enlace para que pueda guiarse del procedimiento de agencia virtual: 
      📌https://www.SAT.gob.pe/AgenciaVirtual/guiainteractiva/

      Para iniciar un procedimiento administrativo vinculado a tránsito o transporte, es obligatorio inscribirse en la Casilla Electrónica del MTC, así recibirás oportunamente nuestras comunicaciones.
      📌https://casilla.mtc.gob.pe/#/registro
      Base Legal: R. Directoral N°023-2024-MTC/18

  # ========== RESPUESTAS CONSULTAS FRECUENTES ==========
  utter_consultas_frecuentes_menu:
  - text: |
      ¿Qué información necesitas sobre papeletas?

      📅 **Plazos y descuentos** - Información sobre fechas de pago
      👤 **Responsable de multa** - Quién debe pagar
      📷 **Imagen de papeleta** - Ver foto de la infracción
      🔢 **Código de infracción** - Consultar qué significa un código
      ⚠️ **Consecuencias de no pagar** - Qué pasa si no pagas

      ¿Sobre qué quieres información?

  utter_plazos_descuentos:
  - text: |
      Estimado ciudadano, puede verificar la información en el siguiente enlace:
      📌https://www.sat.gob.pe/WebSiteV8/Modulos/contenidos/mult_Papeletas_ti_rntv2.aspx

  utter_responsable_multa:
  - text: |
      Estimado ciudadano, puede verificar la información en el siguiente enlace:
      📌https://www.sat.gob.pe/WebSiteV8/Modulos/contenidos/mult_Papeletas_ti_rntv2.aspx

  utter_imagen_papeleta:
  - text: |
      Estimado ciudadano, para consultar su papeleta ingrese aquí:
      📌https://www.sat.gob.pe/WebSitev8/IncioOV2.aspx

  utter_consecuencias_no_pago:
  - text: |
      Estimado ciudadano, si no paga su papeleta dentro de los plazos establecidos, perderá el beneficio. 

      Puede verificar los descuentos en el siguiente link: 
      📌https://www.sat.gob.pe/websitev9/TributosMultas/Papeletas/InformacionCodigodeTransito, numeral 6.

  # ========== RESPUESTAS DE CONFIRMACIÓN ==========
  # Estas respuestas se manejan dentro de los actions inteligentes
  # utter_confirmar_placa, utter_confirmar_dni, etc. no son necesarias

  # ========== RESPUESTAS DE SOLICITUD DE DATOS ==========
  # Estas también se manejan dentro de los actions inteligentes
  # utter_ask_placa, utter_ask_dni, etc. no son necesarias

  # ========== RESPUESTAS DE ERROR ==========
  utter_default:
  - text: |
      No entendí completamente tu solicitud. Puedo ayudarte con:

      🚗 **Papeletas** - Consultas, registro, información
      💳 **Pagos en línea** - Enlaces para pagar
      📋 **Casilla MTC** - Información de registro

      ¿Podrías ser más específico? Por ejemplo:
      • 'Consultar papeletas de mi placa ABC123'
      • 'Información de pagos'

actions:
  # ========== ACTIONS BÁSICAS ==========
  - utter_greet
  - utter_goodbye
  - utter_default

  # ========== ACTIONS OPCIONES PRINCIPALES ==========
  - utter_casilla_mtc
  - utter_pagos_linea

  # ========== ACTIONS PAPELETAS ==========
  - utter_papeletas_menu
  - utter_consulta_pago_menu
  - utter_registrar_papeleta
  - utter_facilidad_pago
  - utter_consultas_frecuentes_menu

  # ========== ACTIONS CONSULTAS FRECUENTES ==========
  - utter_plazos_descuentos
  - utter_responsable_multa
  - utter_imagen_papeleta
  - utter_consecuencias_no_pago

  # ========== CUSTOM ACTIONS (APIs) ==========
  - action_consultar_papeletas
  - action_consultar_codigo_falta
  - action_finalizar_chat

session_config:
  session_expiration_time: 60
  carry_over_slots_to_new_session: false