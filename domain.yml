version: "3.1"

intents:
  # ========== GLOBAL (funcionan siempre) ==========
  - greet
  - goodbye
  - menu_principal

  # ========== GLOBAL - CONSULTAS RÁPIDAS ESPECÍFICAS ==========
  - consulta_rapida_papeletas_placa
  - consulta_rapida_papeletas_dni
  - consulta_rapida_papeletas_ruc
  - consulta_rapida_codigo_falta

  # ========== NAVEGACIÓN A CONTEXTOS ==========
  - ir_a_casilla_mtc        # Opción 1
  - ir_a_pagos_linea        # Opción 2
  - ir_a_papeletas          # Opción 3

  # ========== CONTEXTO PAPELETAS - CONSULTAS ESPECÍFICAS ==========
  - papeletas_consultar_placa
  - papeletas_consultar_dni
  - papeletas_consultar_ruc
  - papeletas_consultar_codigo_falta
  - papeletas_consultar_generico
  - papeletas_registrar
  - papeletas_facilidades
  - papeletas_frecuentes

  # ========== NAVEGACIÓN ==========
  - otra_consulta

entities:
  - placa
  - dni
  - ruc
  - codigo_falta

slots:
  # ========== SOLO PARA LOGGING ==========
  ultimo_documento:
    type: text
    influence_conversation: false
    mappings:
    - type: custom

responses:
  # ========== BÁSICOS ==========
  utter_greet:
  - text: |
      ¡Hola! Soy el asistente virtual del SAT de Lima 👋
      
      Puedo ayudarte con **consultas rápidas**. Puedes escribir directamente, por ejemplo:
      
      ⚡ **PAPELETAS:**
      • "Ver papeletas de mi placa ABC123" - para consultar las papeletas de una placa
      • "Consultar papeletas de mi DNI 12345678" - para consultar papeletas por DNI
      • "Papeletas del RUC 20123456789" - para consultar papeletas de una empresa
      • "¿Qué significa el código C15?" - para conocer el significado de códigos de infracción
      
      O si prefieres explorar las opciones completas:
      
      📋 **OPCIONES PRINCIPALES:**
      Escribe el número o el nombre de la opción que necesitas:
      1️⃣ **Papeletas** - Multas y consultas de tránsito
      2️⃣ **Pagos** - Pagar por internet  
      3️⃣ **Casilla MTC** - Registro obligatorio
      
      ¿Qué necesitas?

  utter_goodbye:
  - text: |
      ¡Gracias por usar el SAT de Lima! 👋
      
      Recuerda que puedes:
      • Consultar papeletas: "Ver papeletas de mi placa ABC123"
      • Información de pagos: "Cómo pago por internet"
      • Registro MTC: "Necesito inscribirme"
      
      ¡Que tengas buen día! 😊

  utter_menu_principal:
  - text: |
      📋 **MENÚ PRINCIPAL SAT LIMA**

      ⚡ **CONSULTAS RÁPIDAS DE PAPELETAS:**
      • "Ver papeletas de mi placa ABC123"
      • "Consultar multas de mi DNI 12345678"
      • "¿Qué significa el código C15?"

      📋 **OPCIONES PRINCIPALES:**
      1️⃣ **Papeletas** - Multas y consultas de tránsito
      2️⃣ **Pagos** - Pagar por internet
      3️⃣ **Casilla MTC** - Registro obligatorio

      ¿Qué necesitas?

  # ========== OPCIÓN 1: CASILLA MTC ==========
  utter_casilla_mtc:
  - text: |
      📋 **CASILLA ELECTRÓNICA MTC**

      Es **obligatorio** inscribirse para cualquier trámite de tránsito o transporte.

      🔗 **Regístrate aquí:** https://casilla.mtc.gob.pe/#/registro

      **¿Por qué es obligatorio?**
      • Para recibir notificaciones oficiales
      • Requisito para todos los trámites vehiculares
      • Base Legal: R. Directoral N°023-2024-MTC/18

      📝 **Ejemplos de lo que puedes decir después:**
      • "Ya me registré, ahora quiero ver mis papeletas"
      • "¿Cómo pago mis multas?"
      • "¿Qué otros trámites puedo hacer?"

      **¿Qué más necesitas?**
      • 'Papeletas' - Consultar multas
      • 'Pagos' - Información de pagos
      • 'Menú principal' - Ver otras opciones

  # ========== OPCIÓN 2: PAGOS ==========
  utter_pagos_linea:
  - text: |
      💳 **PAGAR POR INTERNET**

      🔗 **Página de pagos:** https://www.sat.gob.pe/pagosenlinea/

      💡 **Puedes pagar con:**
      • Tarjetas: Visa, Mastercard, American Express
      • Yape
      • Bancos: BCP, Interbank, BBVA, Scotiabank

      📝 **Ejemplos de lo que puedes decir:**
      • "¿Puedo pagar en cuotas?"
      • "Quiero ver mis papeletas primero"
      • "¿Dónde están las oficinas?"
      • "Información sobre descuentos"

      **¿Qué más necesitas?**
      • 'Papeletas' - Consultar cuánto debes
      • 'Facilidades' - Pagar en cuotas
      • 'Menú principal' - Otras opciones

  # ========== OPCIÓN 3: PAPELETAS MENÚ ==========
  utter_papeletas_menu:
  - text: |
      🚗 **PAPELETAS - ¿Qué necesitas?**

      ⚡ **CONSULTA RÁPIDA AQUÍ:**
      Escribe directamente:
      • **Placa:** "Mi placa es ABC123" - para ver papeletas del vehículo
      • **DNI:** "Mi DNI es 12345678" o solo "87654321" - para consultar tus papeletas personales
      • **RUC:** "RUC 20123456789" - para papeletas de tu empresa
      • **Código:** "¿Qué significa G40?" o "Código G41" - para entender qué infracción cometiste

      📝 **OTRAS OPCIONES:**
      • **"Registrar papeleta"** - Si no aparece tu multa
      • **"Facilidades de pago"** - Pagar en cuotas
      • **"Consultas frecuentes"** - Plazos, descuentos, etc.

      💡 **También puedes preguntar:**
      • "¿Tengo multas pendientes?"
      • "No encuentro mi papeleta"
      • "Quiero pagar en cuotas"
      • "Información sobre descuentos"

      ¿Qué necesitas?

  # ========== PAPELETAS SUB-OPCIONES ==========
  utter_papeletas_registrar:
  - text: |
      📝 **REGISTRAR PAPELETA NO ENCONTRADA**

      Si tu papeleta no aparece en el sistema:

      🔗 **Regístrala aquí:** https://www.sat.gob.pe/websitev8/Popupv2.aspx?t=9&v=%20

      **¿Algo más?**
      • Dame tu placa/DNI/RUC para consultar otras papeletas
      • 'Menú principal' - Otras opciones
      • 'Papeletas' - Volver al menú de papeletas

  utter_papeletas_facilidades:
  - text: |
      💰 **FACILIDADES DE PAGO**

      **Para pagar en cuotas:**
      🔗 **Agencia Virtual SAT:** https://www.sat.gob.pe/websitev9/Servicios/AgenciaVirtual

      **Pasos:**
      1. Regístrate en Agencia Virtual
      2. Ve a 'Facilidades de pago'
      3. Selecciona tus papeletas para fraccionar

      ⚠️ **Importante:** Primero inscríbete en Casilla MTC

      **¿Algo más?**
      • Dame tu placa/DNI/RUC para consultar papeletas
      • 'Casilla MTC' - Información de registro
      • 'Menú principal' - Otras opciones

  utter_papeletas_frecuentes:
  - text: |
      ❓ **CONSULTAS FRECUENTES PAPELETAS**

      📋 **Enlaces informativos:**

      🕒 **Plazos y descuentos:**
      https://www.sat.gob.pe/WebSiteV8/Modulos/contenidos/mult_Papeletas_ti_rntv2.aspx

      📷 **Ver imagen de papeleta:**
      https://www.sat.gob.pe/WebSitev8/IncioOV2.aspx

      💡 **Para consultar códigos de infracción:**
      Escribe: "¿Qué significa C15?" o "Código M08"

      **¿Algo más?**
      • Dame tu placa/DNI/RUC para consultar papeletas
      • 'Menú principal' - Otras opciones

  # ========== NAVEGACIÓN GLOBAL ==========
  utter_otra_consulta:
  - text: |
      🔄 **NUEVA CONSULTA**

      **¿Qué quieres consultar?**

      🚗 **Papeletas:** "Ver papeletas de mi placa ABC123"
      💳 **Pagos:** "Información de pagos"
      📋 **Casilla MTC:** "Necesito inscribirme"

      **O puedes decir:**
      • 'Menú principal' - Ver todas las opciones
      • "¿Qué significa C15?" - Consultar códigos

      ¿Qué necesitas?

  # ========== FALLBACK GLOBAL ==========
  utter_default:
  - text: |
      No entendí completamente tu mensaje.

      **Puedes decir:**
      🚗 **Papeletas:** "Ver papeletas de mi placa ABC123"
      💳 **Pagos:** "Cómo pago por internet"
      📋 **Casilla MTC:** "Necesito inscribirme"
      📋 **Menú:** "Menú principal"

      **O consultar códigos:**
      • "¿Qué significa C15?"

      ¿Qué necesitas?

actions:
  # ========== RESPONSES ESTÁTICAS ==========
  - utter_greet
  - utter_goodbye
  - utter_menu_principal
  - utter_casilla_mtc
  - utter_pagos_linea
  - utter_papeletas_menu
  - utter_papeletas_registrar
  - utter_papeletas_facilidades
  - utter_papeletas_frecuentes
  - utter_otra_consulta
  - utter_default

  # ========== CUSTOM ACTIONS ==========
  - action_consultar_papeletas
  - action_consultar_codigo_falta
  - action_finalizar_chat

session_config:
  session_expiration_time: 60
  carry_over_slots_to_new_session: false